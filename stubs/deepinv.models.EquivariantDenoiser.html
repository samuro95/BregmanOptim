

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EquivariantDenoiser &mdash; deepinverse 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />

  
    <link rel="shortcut icon" href="../_static/logo.ico"/>
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=2709fde1"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=35a8b989"></script>
      <script>window.MathJax = {"tex": {"equationNumbers": {"autoNumber": "AMS", "useLabelIds": true}, "macros": {"forw": ["{A\\left({#1}\\right)}", 1], "noise": ["{N\\left({#1}\\right)}", 1], "inverse": ["{R\\left({#1}\\right)}", 1], "inversef": ["{R\\left({#1},{#2}\\right)}", 2], "reg": ["{g_\\sigma\\left({#1}\\right)}", 1], "regname": "g_\\sigma", "sensor": ["{\\eta\\left({#1}\\right)}", 1], "datafid": ["{f\\left({#1},{#2}\\right)}", 2], "datafidname": "f", "distance": ["{d\\left({#1},{#2}\\right)}", 2], "distancename": "d", "denoiser": ["{\\operatorname{D}_{{#2}}\\left({#1}\\right)}", 2], "denoisername": "\\operatorname{D}_{\\sigma}", "xset": "\\mathcal{X}", "yset": "\\mathcal{Y}", "group": "\\mathcal{G}", "metric": ["{d\\left({#1},{#2}\\right)}", 2], "loss": ["{\\mathcal\\left({#1}\\right)}", 1], "conj": ["{\\overline{#1}^{\\top}}", 1]}}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="PatchGANDiscriminator" href="deepinv.models.PatchGANDiscriminator.html" />
    <link rel="prev" title="ICNN" href="deepinv.models.ICNN.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >

          
          
          <a href="../index.html">
            
              <img src="../_static/deepinv_logolarge.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../deepinv.physics.html">Physics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deepinv.datasets.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deepinv.utils.html">Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deepinv.loss.html">Loss</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deepinv.metric.html">Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deepinv.transform.html">Transforms</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../deepinv.denoisers.html">Denoisers</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../deepinv.denoisers.html#classical-denoisers">Classical Denoisers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deepinv.denoisers.html#deep-denoisers">Deep Denoisers</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../deepinv.denoisers.html#equivariant-denoisers">Equivariant Denoisers</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">EquivariantDenoiser</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#deepinv.models.EquivariantDenoiser"><code class="docutils literal notranslate"><span class="pre">EquivariantDenoiser</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#examples-using-equivariantdenoiser">Examples using <code class="docutils literal notranslate"><span class="pre">EquivariantDenoiser</span></code>:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../deepinv.denoisers.html#adversarial-networks">Adversarial Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deepinv.denoisers.html#complex-denoisers">Complex Denoisers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deepinv.denoisers.html#pretrained-weights">Pretrained Weights</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../deepinv.optim.html">Optim</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deepinv.iterative.html">Iterative Reconstruction (PnP, RED, etc.)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deepinv.unfolded.html">Unfolded Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deepinv.sampling.html">Diffusion Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deepinv.other_models.html">Other Reconstruction Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deepinv.multigpu.html">Using multiple GPUs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deepinv.notation.html">Math Notation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deepinv.contributing.html">How to Contribute</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">deepinverse</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../deepinv.denoisers.html">Denoisers</a></li>
      <li class="breadcrumb-item active">EquivariantDenoiser</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/stubs/deepinv.models.EquivariantDenoiser.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="equivariantdenoiser">
<h1>EquivariantDenoiser<a class="headerlink" href="#equivariantdenoiser" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="deepinv.models.EquivariantDenoiser">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepinv.models.</span></span><span class="sig-name descname"><span class="pre">EquivariantDenoiser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">denoiser</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="deepinv.transform.Transform.html#deepinv.transform.Transform" title="deepinv.transform.base.Transform"><span class="pre">Transform</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.4/library/constants.html#None" title="(in Python v3.4)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deepinv/models/equivariant.html#EquivariantDenoiser"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepinv.models.EquivariantDenoiser" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="http://pytorch.org/docs/2.0/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<p>Turns the input denoiser into an equivariant denoiser with respect to geometric transforms.</p>
<p>Recall that a denoiser is equivariant with respect to a group of transformations if it commutes with the action of
the group. More precisely, let <span class="math notranslate nohighlight">\(\mathcal{G}\)</span> be a group of transformations <span class="math notranslate nohighlight">\(\{T_g\}_{g\in \mathcal{G}}\)</span>
and <span class="math notranslate nohighlight">\(\denoisername\)</span> a denoiser. Then, <span class="math notranslate nohighlight">\(\denoisername\)</span> is equivariant with respect to <span class="math notranslate nohighlight">\(\mathcal{G}\)</span>
if <span class="math notranslate nohighlight">\(\denoisername(T_g(x)) = T_g(\denoisername(x))\)</span> for any image <span class="math notranslate nohighlight">\(x\)</span> and any <span class="math notranslate nohighlight">\(g\in \mathcal{G}\)</span>.</p>
<p>The denoiser can be turned into an equivariant denoiser by averaging over the group of transforms, i.e.</p>
<div class="math notranslate nohighlight">
\[\operatorname{D}^{\text{eq}}_{\sigma}(x) = \frac{1}{|\mathcal{G}|}\sum_{g\in \mathcal{G}} T_g^{-1}(\operatorname{D}_{\sigma}(T_g(x))).\]</div>
<p>Otherwise, as proposed in <a class="reference external" href="https://arxiv.org/abs/2312.01831">https://arxiv.org/abs/2312.01831</a>, a Monte Carlo approximation can be obtained by
sampling <span class="math notranslate nohighlight">\(g \sim \mathcal{G}\)</span> at random and applying</p>
<div class="math notranslate nohighlight">
\[\operatorname{D}^{\text{MC}}_{\sigma}(x) = T_g^{-1}(\operatorname{D}_{\sigma}(T_g(x))).\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We have implemented many popular geometric transforms, see <a class="reference internal" href="../deepinv.transform.html#transform"><span class="std std-ref">docs</span></a>. You can set the number of Monte Carlo samples by passing <code class="docutils literal notranslate"><span class="pre">n_trans</span></code>
into the transforms, for example <code class="docutils literal notranslate"><span class="pre">Rotate(n_trans=2)</span></code> will average over 2 samples per call. For rotate and reflect, by setting <code class="docutils literal notranslate"><span class="pre">n_trans</span></code>
to the maximum (e.g. 4 for 90 degree rotations, 2 for 1D reflections), it will average over the whole group, for example:</p>
<p><code class="docutils literal notranslate"><span class="pre">Rotate(n_trans=4,</span> <span class="pre">multiples=90,</span> <span class="pre">positive=True)</span> <span class="pre">*</span> <span class="pre">Reflect(n_trans=2,</span> <span class="pre">dims=[-1])</span></code></p>
</div>
<p>See <a class="reference internal" href="../auto_examples/basics/demo_transforms.html#sphx-glr-auto-examples-basics-demo-transforms-py"><span class="std std-ref">Image transforms for equivariance &amp; augmentations</span></a> for an example.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>denoiser</strong> (<em>callable</em>) – Denoiser <span class="math notranslate nohighlight">\(\operatorname{D}_{\sigma}\)</span>.</p></li>
<li><p><strong>transform</strong> (<a class="reference internal" href="deepinv.transform.Transform.html#deepinv.transform.Transform" title="deepinv.transform.Transform"><em>Transform</em></a>) – geometric transformation. If None, defaults to rotations of multiples of 90 with horizontal flips (see note above).
See <a class="reference internal" href="../deepinv.transform.html#transform"><span class="std std-ref">docs</span></a> for list of available transforms.</p></li>
<li><p><strong>random</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/functions.html#bool" title="(in Python v3.4)"><em>bool</em></a>) – if True, the denoiser is applied to a randomly transformed version of the input image
each time i.e. a Monte-Carlo approximation of an equivariant denoiser.
If False, the denoiser is applied to the average of all the transformed images, turning the denoiser into an
equivariant denoiser with respect to the chosen group of transformations. Ignored if <code class="docutils literal notranslate"><span class="pre">transform</span></code> is provided.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="deepinv.models.EquivariantDenoiser.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">denoiser_args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">denoiser_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deepinv/models/equivariant.html#EquivariantDenoiser.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepinv.models.EquivariantDenoiser.forward" title="Link to this definition"></a></dt>
<dd><p>Symmetrize the denoiser by the transformation to create an equivariant denoiser and apply to input.</p>
<p>The symmetrization collects the average if multiple samples are used (controlled with <code class="docutils literal notranslate"><span class="pre">n_trans</span></code> in the transform).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="http://pytorch.org/docs/2.0/tensors.html#torch.Tensor" title="(in PyTorch v2.0)"><em>torch.Tensor</em></a>) – input image.</p></li>
<li><p><strong>*denoiser_args</strong> – args for denoiser function e.g. sigma noise level.</p></li>
<li><p><strong>**denoiser_kwargs</strong> – kwargs for denoiser function e.g. sigma noise level.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>denoised image.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<section id="examples-using-equivariantdenoiser">
<span id="sphx-glr-backref-deepinv-models-equivariantdenoiser"></span><h2>Examples using <code class="docutils literal notranslate"><span class="pre">EquivariantDenoiser</span></code>:<a class="headerlink" href="#examples-using-equivariantdenoiser" title="Link to this heading"></a></h2>
<div class="sphx-glr-thumbnails"><div class="sphx-glr-thumbcontainer" tooltip="We demonstrate the use of our deepinv.transform module for use in solving imaging problems. These can be used for:"><img alt="" src="../_images/sphx_glr_demo_transforms_thumb.png" />
<p><a class="reference internal" href="../auto_examples/basics/demo_transforms.html#sphx-glr-auto-examples-basics-demo-transforms-py"><span class="std std-ref">Image transforms for equivariance &amp; augmentations</span></a></p>
  <div class="sphx-glr-thumbnail-title">Image transforms for equivariance & augmentations</div>
</div></div></section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="deepinv.models.ICNN.html" class="btn btn-neutral float-left" title="ICNN" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="deepinv.models.PatchGANDiscriminator.html" class="btn btn-neutral float-right" title="PatchGANDiscriminator" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, DeepInv.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-NSEKFKYSGR"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-NSEKFKYSGR', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>