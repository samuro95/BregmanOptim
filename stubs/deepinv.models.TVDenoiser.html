

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TVDenoiser &mdash; deepinverse 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />

  
    <link rel="shortcut icon" href="../_static/logo.ico"/>
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=2709fde1"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=35a8b989"></script>
      <script>window.MathJax = {"tex": {"equationNumbers": {"autoNumber": "AMS", "useLabelIds": true}, "macros": {"forw": ["{A\\left({#1}\\right)}", 1], "noise": ["{N\\left({#1}\\right)}", 1], "inverse": ["{R\\left({#1}\\right)}", 1], "inversef": ["{R\\left({#1},{#2}\\right)}", 2], "reg": ["{g_\\sigma\\left({#1}\\right)}", 1], "regname": "g_\\sigma", "sensor": ["{\\eta\\left({#1}\\right)}", 1], "datafid": ["{f\\left({#1},{#2}\\right)}", 2], "datafidname": "f", "distance": ["{d\\left({#1},{#2}\\right)}", 2], "distancename": "d", "denoiser": ["{\\operatorname{D}_{{#2}}\\left({#1}\\right)}", 2], "denoisername": "\\operatorname{D}_{\\sigma}", "xset": "\\mathcal{X}", "yset": "\\mathcal{Y}", "group": "\\mathcal{G}", "metric": ["{d\\left({#1},{#2}\\right)}", 2], "loss": ["{\\mathcal\\left({#1}\\right)}", 1], "conj": ["{\\overline{#1}^{\\top}}", 1]}}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="TGVDenoiser" href="deepinv.models.TGVDenoiser.html" />
    <link rel="prev" title="MedianFilter" href="deepinv.models.MedianFilter.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >

          
          
          <a href="../index.html">
            
              <img src="../_static/deepinv_logolarge.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../deepinv.physics.html">Physics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deepinv.datasets.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deepinv.utils.html">Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deepinv.loss.html">Loss</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deepinv.metric.html">Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deepinv.transform.html">Transforms</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../deepinv.denoisers.html">Denoisers</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../deepinv.denoisers.html#classical-denoisers">Classical Denoisers</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="deepinv.models.BM3D.html">BM3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="deepinv.models.MedianFilter.html">MedianFilter</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">TVDenoiser</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#deepinv.models.TVDenoiser"><code class="docutils literal notranslate"><span class="pre">TVDenoiser</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deepinv.models.TGVDenoiser.html">TGVDenoiser</a></li>
<li class="toctree-l3"><a class="reference internal" href="deepinv.models.WaveletDenoiser.html">WaveletDenoiser</a></li>
<li class="toctree-l3"><a class="reference internal" href="deepinv.models.WaveletDictDenoiser.html">WaveletDictDenoiser</a></li>
<li class="toctree-l3"><a class="reference internal" href="deepinv.models.EPLLDenoiser.html">EPLLDenoiser</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../deepinv.denoisers.html#deep-denoisers">Deep Denoisers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deepinv.denoisers.html#equivariant-denoisers">Equivariant Denoisers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deepinv.denoisers.html#adversarial-networks">Adversarial Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deepinv.denoisers.html#complex-denoisers">Complex Denoisers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deepinv.denoisers.html#pretrained-weights">Pretrained Weights</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../deepinv.optim.html">Optim</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deepinv.iterative.html">Iterative Reconstruction (PnP, RED, etc.)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deepinv.unfolded.html">Unfolded Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deepinv.sampling.html">Diffusion Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deepinv.other_models.html">Other Reconstruction Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deepinv.multigpu.html">Using multiple GPUs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deepinv.notation.html">Math Notation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deepinv.contributing.html">How to Contribute</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">deepinverse</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../deepinv.denoisers.html">Denoisers</a></li>
      <li class="breadcrumb-item active">TVDenoiser</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/stubs/deepinv.models.TVDenoiser.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tvdenoiser">
<h1>TVDenoiser<a class="headerlink" href="#tvdenoiser" title="Link to this heading">ÔÉÅ</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="deepinv.models.TVDenoiser">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepinv.models.</span></span><span class="sig-name descname"><span class="pre">TVDenoiser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.99</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_it_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deepinv/models/tv.html#TVDenoiser"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepinv.models.TVDenoiser" title="Link to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference external" href="http://pytorch.org/docs/2.0/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<p>Proximal operator of the isotropic Total Variation operator.</p>
<p>This algorithm converges to the unique image <span class="math notranslate nohighlight">\(x\)</span> that is the solution of</p>
<div class="math notranslate nohighlight">
\[\underset{x}{\arg\min} \;  \frac{1}{2}\|x-y\|_2^2 + \gamma \|Dx\|_{1,2},\]</div>
<p>where <span class="math notranslate nohighlight">\(D\)</span> maps an image to its gradient field.</p>
<p>The problem is solved with an over-relaxed Chambolle-Pock algorithm (see L. Condat, ‚ÄúA primal-dual splitting method
for convex optimization  involving Lipschitzian, proximable and linear composite terms‚Äù, J. Optimization Theory and
Applications, vol. 158, no. 2, pp. 460-479, 2013.</p>
<p>Code (and description) adapted from Laurent Condat‚Äôs matlab version (<a class="reference external" href="https://lcondat.github.io/software.html">https://lcondat.github.io/software.html</a>) and
Daniil Smolyakov‚Äôs <a class="reference external" href="https://github.com/RoundedGlint585/TGVDenoising/blob/master/TGV%20WithoutHist.ipynb">code</a>.</p>
<p>This algorithm is implemented with warm restart, i.e. the primary and dual variables are kept in memory
between calls to the forward method. This speeds up the computation when using this class in an iterative algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/functions.html#bool" title="(in Python v3.4)"><em>bool</em></a>) ‚Äì Whether to print computation details or not. Default: False.</p></li>
<li><p><strong>tau</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/functions.html#float" title="(in Python v3.4)"><em>float</em></a>) ‚Äì Stepsize for the primal update. Default: 0.01.</p></li>
<li><p><strong>rho</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/functions.html#float" title="(in Python v3.4)"><em>float</em></a>) ‚Äì Over-relaxation parameter. Default: 1.99.</p></li>
<li><p><strong>n_it_max</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/functions.html#int" title="(in Python v3.4)"><em>int</em></a>) ‚Äì Maximum number of iterations. Default: 1000.</p></li>
<li><p><strong>crit</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/functions.html#float" title="(in Python v3.4)"><em>float</em></a>) ‚Äì Convergence criterion. Default: 1e-5.</p></li>
<li><p><strong>x2</strong> (<a class="reference external" href="http://pytorch.org/docs/2.0/tensors.html#torch.Tensor" title="(in PyTorch v2.0)"><em>torch.Tensor</em></a><em>, </em><em>None</em>) ‚Äì Primary variable for warm restart. Default: None.</p></li>
<li><p><strong>u2</strong> (<a class="reference external" href="http://pytorch.org/docs/2.0/tensors.html#torch.Tensor" title="(in PyTorch v2.0)"><em>torch.Tensor</em></a><em>, </em><em>None</em>) ‚Äì Dual variable for warm restart. Default: None.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The regularization term <span class="math notranslate nohighlight">\(\|Dx\|_{1,2}\)</span> is implicitly normalized by its Lipschitz constant, i.e.
<span class="math notranslate nohighlight">\(\sqrt{8}\)</span>, see e.g. A. Beck and M. Teboulle, ‚ÄúFast gradient-based algorithms for constrained total
variation image denoising and deblurring problems‚Äù, IEEE T. on Image Processing. 18(11), 2419-2434, 2009.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For using TV as a prior for Plug and Play algorithms, it is recommended to use the class
<a class="reference internal" href="deepinv.optim.TVPrior.html#deepinv.optim.TVPrior" title="deepinv.optim.prior.TVPrior"><code class="xref py py-class docutils literal notranslate"><span class="pre">TVPrior</span></code></a> instead. In particular, it allows to evaluate TV.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="deepinv.models.TVDenoiser.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deepinv/models/tv.html#TVDenoiser.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepinv.models.TVDenoiser.forward" title="Link to this definition">ÔÉÅ</a></dt>
<dd><p>Computes the proximity operator of the TV norm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<a class="reference external" href="http://pytorch.org/docs/2.0/tensors.html#torch.Tensor" title="(in PyTorch v2.0)"><em>torch.Tensor</em></a>) ‚Äì Noisy image.</p></li>
<li><p><strong>ths</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/functions.html#float" title="(in Python v3.4)"><em>float</em></a><em>, </em><a class="reference external" href="http://pytorch.org/docs/2.0/tensors.html#torch.Tensor" title="(in PyTorch v2.0)"><em>torch.Tensor</em></a>) ‚Äì Regularization parameter <span class="math notranslate nohighlight">\(\gamma\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Denoised image.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepinv.models.TVDenoiser.nabla">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nabla</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deepinv/models/tv.html#TVDenoiser.nabla"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepinv.models.TVDenoiser.nabla" title="Link to this definition">ÔÉÅ</a></dt>
<dd><p>Applies the finite differences operator associated with tensors of the same shape as x.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepinv.models.TVDenoiser.nabla_adjoint">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nabla_adjoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deepinv/models/tv.html#TVDenoiser.nabla_adjoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepinv.models.TVDenoiser.nabla_adjoint" title="Link to this definition">ÔÉÅ</a></dt>
<dd><p>Applies the adjoint of the finite difference operator.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepinv.models.TVDenoiser.prox_tau_fx">
<span class="sig-name descname"><span class="pre">prox_tau_fx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deepinv/models/tv.html#TVDenoiser.prox_tau_fx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepinv.models.TVDenoiser.prox_tau_fx" title="Link to this definition">ÔÉÅ</a></dt>
<dd><p>Proximal operator of the function <span class="math notranslate nohighlight">\(\frac{1}{2}\|x-y\|_2^2\)</span>.</p>
</dd></dl>

</dd></dl>

<span class="target" id="sphx-glr-backref-deepinv-models-tvdenoiser"></span></section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="deepinv.models.MedianFilter.html" class="btn btn-neutral float-left" title="MedianFilter" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="deepinv.models.TGVDenoiser.html" class="btn btn-neutral float-right" title="TGVDenoiser" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, DeepInv.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-NSEKFKYSGR"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-NSEKFKYSGR', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>